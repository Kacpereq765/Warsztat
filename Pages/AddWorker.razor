@page "/AddWorker"
@using MudBlazor
@using warsztat.Services
@inject NavigationManager NavigationManager
@inject IWorkerService workerService
@using warsztat.Models

<h3>Dodaj pracownika</h3>

<MudContainer>
    <MudCard>
        <MudCardContent>
            <MudForm @ref="form" Model="worker">
                <MudTextField @bind-Value="worker.FirstName" Variant="Variant.Outlined" Label="Imię pracownika" Required="true" />
                <MudDivider />
                <MudDivider />
                <MudDivider />
                <MudTextField @bind-Value="worker.LastName" Variant="Variant.Outlined" Label="Nazwisko pracownika" Required="true" />
                <MudDivider />
                <MudDivider />
                <MudDivider />
                <MudTextField @bind-Value="worker.Age" Class="border-solid border-1 mud-border-primary pa-2" Label="Wiek pracownika" Required="true" />
                <MudDivider />
                <MudDivider />
                <MudDivider />
                <MudTextField @bind-Value="worker.Address" Variant="Variant.Outlined" Label="Adres zamieszkania pracownika" Required="true" />
                <MudDivider />
                <MudDivider />
                <MudDivider />
                <MudTextField @bind-Value="worker.Position" Variant="Variant.Outlined" Label="Stanowisko pracownika" Required="true" />
                <MudDivider />
                <MudDivider />
                <MudDivider />
                <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="SubmitForm">Dodaj pracownika</MudButton>
            </MudForm>
            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="Return">Powrót</MudButton>
        </MudCardContent>
    </MudCard>
</MudContainer>

@code {
    private Worker worker = new();
    private MudForm form;

    private async Task SubmitForm()
    {
        if (form.IsValid)
        {
            Console.WriteLine($"Imię: {worker.FirstName}, Nazwisko: {worker.LastName}, Wiek: {worker.Age}, Adres: {worker.Address}, Stanowisko: {worker.Position}");
            await workerService.AddWorkerAsync(worker); // Zapis do bazy przez serwis
            NavigationManager.NavigateTo("/ViewWorker");
        }
        else
        {
            Console.WriteLine("Formularz nie jest ważny.");
        }
    }

    private void Return()
    {
        NavigationManager.NavigateTo("/ViewWorker");
    }
}
